# ìš”ì²­ ìƒíƒœ í•„ë“œ ì¶”ê°€ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”
`textbook_requests` í…Œì´ë¸”ì— `status`ì™€ `admin_memo` ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ì—¬ ìš”ì²­ êµì¬ ê´€ë¦¬ ê¸°ëŠ¥ì„ ê°•í™”í•©ë‹ˆë‹¤.

---

## ğŸ—„ï¸ 1. Supabase SQL ì‹¤í–‰

### 1-1. Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†
1. https://supabase.com ë¡œê·¸ì¸
2. í”„ë¡œì íŠ¸ ì„ íƒ
3. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ **"SQL Editor"** í´ë¦­

### 1-2. SQL ì‹¤í–‰
1. **"New query"** í´ë¦­
2. ì•„ë˜ SQL ì½”ë“œë¥¼ ë¶™ì—¬ë„£ê¸°:

```sql
-- textbook_requests í…Œì´ë¸”ì— status ì»¬ëŸ¼ ì¶”ê°€

-- 1. status ENUM íƒ€ì… ìƒì„± (ì´ë¯¸ ìˆìœ¼ë©´ ë¬´ì‹œ)
DO $$ BEGIN
  CREATE TYPE request_status AS ENUM ('pending', 'in_progress', 'completed', 'rejected');
EXCEPTION
  WHEN duplicate_object THEN null;
END $$;

-- 2. status ì»¬ëŸ¼ ì¶”ê°€ (ì´ë¯¸ ìˆìœ¼ë©´ ë¬´ì‹œ)
DO $$ BEGIN
  ALTER TABLE textbook_requests 
  ADD COLUMN status request_status DEFAULT 'pending';
EXCEPTION
  WHEN duplicate_column THEN null;
END $$;

-- 3. admin_memo ì»¬ëŸ¼ ì¶”ê°€ (ì„ íƒì‚¬í•­)
DO $$ BEGIN
  ALTER TABLE textbook_requests 
  ADD COLUMN admin_memo TEXT;
EXCEPTION
  WHEN duplicate_column THEN null;
END $$;

-- 4. status ì¸ë±ìŠ¤ ì¶”ê°€
CREATE INDEX IF NOT EXISTS idx_textbook_requests_status 
ON textbook_requests(status);

-- 5. ê¸°ì¡´ ë°ì´í„° ì—…ë°ì´íŠ¸ (ëª¨ë‘ pendingìœ¼ë¡œ)
UPDATE textbook_requests 
SET status = 'pending' 
WHERE status IS NULL;

-- ì½”ë©˜íŠ¸ ì¶”ê°€
COMMENT ON COLUMN textbook_requests.status IS 'ìš”ì²­ ìƒíƒœ: pending(ëŒ€ê¸°), in_progress(ì²˜ë¦¬ì¤‘), completed(ì™„ë£Œ), rejected(ê±°ì ˆ)';
COMMENT ON COLUMN textbook_requests.admin_memo IS 'ê´€ë¦¬ì ë©”ëª¨';
```

3. **"RUN"** ë²„íŠ¼ í´ë¦­

---

## âœ… 2. ì‹¤í–‰ ê²°ê³¼ í™•ì¸

### ì„±ê³µ ì‹œ:
```
Success. No rows returned
```

### ì´ë¯¸ ì»¬ëŸ¼ì´ ìˆëŠ” ê²½ìš°:
```
Success. No rows returned
```
(ì—ëŸ¬ ì—†ì´ í†µê³¼ë¨)

---

## ğŸ” 3. í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ í™•ì¸

### 3-1. í…Œì´ë¸” ì—ë””í„°ë¡œ í™•ì¸
1. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ **"Table Editor"** í´ë¦­
2. `textbook_requests` í…Œì´ë¸” ì„ íƒ
3. ìƒˆë¡œ ì¶”ê°€ëœ ì»¬ëŸ¼ í™•ì¸:
   - âœ… `status` (request_status íƒ€ì…, ê¸°ë³¸ê°’: 'pending')
   - âœ… `admin_memo` (text íƒ€ì…)

### 3-2. SQLë¡œ í™•ì¸
```sql
SELECT column_name, data_type, column_default
FROM information_schema.columns
WHERE table_name = 'textbook_requests'
ORDER BY ordinal_position;
```

---

## ğŸ“Š 4. status ê°’ ì„¤ëª…

| ê°’ | í•œê¸€ | ì„¤ëª… |
|---|---|---|
| `pending` | ëŒ€ê¸° | ì•„ì§ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ìš”ì²­ |
| `in_progress` | ì²˜ë¦¬ì¤‘ | í˜„ì¬ ì²˜ë¦¬ ì§„í–‰ ì¤‘ |
| `completed` | ì™„ë£Œ | ì²˜ë¦¬ ì™„ë£Œ (êµì¬ ì¶”ê°€ë¨) |
| `rejected` | ê±°ì ˆ | ìš”ì²­ ê±°ì ˆ |

---

## ğŸ¯ 5. ë©”ì¸ í˜ì´ì§€ ìš”ì²­ ìˆœìœ„

- **í‘œì‹œ ëŒ€ìƒ**: `status = 'pending'`ì¸ ìš”ì²­ë§Œ í‘œì‹œ
- **ì •ë ¬**: `request_count` ë‚´ë¦¼ì°¨ìˆœ
- **ì œí•œ**: TOP 5

---

## ğŸš¨ ë¬¸ì œ í•´ê²°

### ì—ëŸ¬: `ERROR: type "request_status" already exists`
- **ì›ì¸**: ENUM íƒ€ì…ì´ ì´ë¯¸ ì¡´ì¬
- **í•´ê²°**: ì •ìƒ ë™ì‘, ë¬´ì‹œ ê°€ëŠ¥

### ì—ëŸ¬: `ERROR: column "status" of relation "textbook_requests" already exists`
- **ì›ì¸**: ì»¬ëŸ¼ì´ ì´ë¯¸ ì¡´ì¬
- **í•´ê²°**: ì •ìƒ ë™ì‘, ë¬´ì‹œ ê°€ëŠ¥

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] SQL ì‹¤í–‰ ì™„ë£Œ (`Success` í™•ì¸)
- [ ] `status` ì»¬ëŸ¼ ì¶”ê°€ í™•ì¸
- [ ] `admin_memo` ì»¬ëŸ¼ ì¶”ê°€ í™•ì¸
- [ ] ê¸°ì¡´ ë°ì´í„°ê°€ `pending`ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨
- [ ] ì¸ë±ìŠ¤ ìƒì„± í™•ì¸

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

1. ë¡œì»¬ ê°œë°œ ì„œë²„ ì¬ì‹œì‘ (í•„ìš”ì‹œ)
2. `/admin/requests` í˜ì´ì§€ ì ‘ì†
3. ìš”ì²­ ìƒíƒœ ë³€ê²½ í…ŒìŠ¤íŠ¸
4. ë©”ëª¨ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

